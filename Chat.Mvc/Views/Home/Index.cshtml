@{
    ViewData["Title"] = "Fancy Chat";
}

<div class="container">
    <div class="form-row mt-3">
        <div class="col-sm-3 my-2">
            <input id="user" type="text" class="form-control" placeholder="User" />
        </div>
        <div class="col-sm-7 my-2">
            <input id="message" type="text" class="form-control" placeholder="Message" />
        </div>
        <div class="col my-2">
            <button id="send" class="btn btn-primary align-bottom">Send</button>
        </div>
    </div>
</div>

<hr />

<div class="container">
    <ul id="chat" class="m-0"></ul>
</div>

@section Scripts
{
    <script src="~/js/signalr/dist/browser/signalr.min.js"></script>
    <script>

        $(function()
        {
            const connection = new signalR.HubConnectionBuilder().withUrl("/chat").build();

            connection.on("Receive", function(user, msg)
            {
                $("#chat").append(`<li><strong>${user}:</strong> ${msg}</li>`);
            });

            $("#send").click(function()
            {
                connection.invoke("Broadcast", $("#user").val(), $("#message").val());
            });

            connection.start();
        });

    </script>
}
